---

- name: "Test sonic CLI"
  hosts: datacenter
  gather_facts: no
  connection: network_cli
  collections:
    - dellemc_networking.sonic
  tasks:

  - name: Test sonic single command
    sonic_command:
       commands: 'show interface status'
    register: cmd_op

  - name: Test sonic single command with wait_for
    sonic_command:
       commands: 'show platform '
       wait_for: 
         - result[0] contains Del
    register: cmd_op

  - name: Test sonic multiple command with wait_for
    sonic_command:
       commands:
         - 'show platform'
         - 'show system'
       wait_for:
         - result[0] contains Dell
         - result[1] contains Hostname
    register: cmd_op

  - name: Test sonic commands with wait_for negative case
    sonic_command:
       commands: 
         - 'show platform'
         - 'show system'
       wait_for: 
         - result[0] contains Fel
         - result[1] contains Hostname
    register: cmd_op
    ignore_errors: yes

  - name: Test sonic commands with wait_for and match=any
    sonic_command:
       commands:
         - 'show platform'
         - 'show system'
       wait_for:
         - result[0] contains Fel
         - result[1] contains Hostname
       match: any
       retries: 3
       interval: 2
    register: cmd_op

  - name: Test sonic command with prompt handling
    sonic_command:
       commands:
         - command: 'image remove all'
           prompt: '\[y/N\]:$'
           answer: 'N'
    register: cmd_op

